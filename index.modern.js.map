{"version":3,"file":"index.modern.js","sources":["index.jsx"],"sourcesContent":["import * as readline from 'node:readline';\nimport React, { useContext, useState, useEffect } from 'react';\nimport { Box, render, Text, useFocus, useInput } from 'ink';\n\nconst FocusWithinContext = React.createContext();\n\nfunction FocusProvider(props) {\n  const { children } = props;\n  const [focusWithin, setFocusWithin] = useState('');\n\n  return (\n    <FocusWithinContext.Provider value={{ focusWithin, setFocusWithin }}>\n      {children}\n    </FocusWithinContext.Provider>\n  );\n}\n\nfunction useFocusWithin() {\n  const { focusWithin, setFocusWithin } = useContext(FocusWithinContext);\n\n  return [\n    (callback) => {\n      return callback(focusWithin);\n    },\n    (id, isFocused) => {\n      useEffect(() => {\n        if (isFocused) {\n          setFocusWithin(id);\n        }\n      }, [isFocused, setFocusWithin, id]);\n    }\n  ];\n}\n\n//------------------------------------------------------------------------------\n\nreadline.emitKeypressEvents(process.stdin);\n\nprocess.stdin.on('keypress', function (str, key) {\n  if (key && key.name === 'q') {\n    process.stdin.pause();\n  }\n});\nprocess.stdin.setRawMode(true);\n\n//------------------------------------------------------------------------------\n\nfunction Item(props) {\n  const { id, label } = props;\n  const { isFocused } = useFocus({ id });\n  const [, setFocusWithin] = useFocusWithin();\n\n  setFocusWithin(id, isFocused);\n\n  return (\n    <Text id={id} inverse={isFocused}>{label}</Text>\n  );\n}\n\nfunction Pane(props) {\n  const { children, id, ids } = props;\n\n  const [checkFocusWithin] = useFocusWithin();\n\n  const isFocusWithin = checkFocusWithin((id) => {\n    return ids.has(id);\n  });\n\n  useInput(\n    (input, key) => {\n      if (isFocusWithin && key.return) {\n        console.log(`I'm ${id}`);\n      }\n    }\n  );\n\n  return (\n    <Box\n      borderColor={isFocusWithin ? 'green' : 'red'}\n      borderDimColor={!isFocusWithin}\n      borderStyle=\"single\"\n      flexDirection=\"column\"\n      height=\"100%\"\n      width=\"50%\"\n    >\n      {children}\n    </Box>\n  );\n}\n\nfunction App() {\n  const idSet1 = new Set(['item-1', 'item-2', 'item-3']);\n  const idSet2 = new Set(['item-4', 'item-5', 'item-6']);\n\n  return (\n    <React.Fragment>\n      <FocusProvider>\n        <Text>Press Tab to focus next item. Press q to exit.</Text>\n        <Box flexDirection=\"row\">\n          <Pane id=\"pane-1\" ids={idSet1}>\n            <Item id=\"item-1\" label=\"Item 1\" />\n            <Item id=\"item-2\" label=\"Item 2\" />\n            <Item id=\"item-3\" label=\"Item 3\" />\n          </Pane>\n          <Pane id=\"pane-2\" ids={idSet2}>\n            <Item id=\"item-4\" label=\"Item 4\" />\n            <Item id=\"item-5\" label=\"Item 5\" />\n            <Item id=\"item-6\" label=\"Item 6\" />\n          </Pane>\n        </Box>\n      </FocusProvider>\n    </React.Fragment>\n  );\n}\n\nrender(<App />);\n"],"names":["FocusWithinContext","React","createContext","FocusProvider","props","children","focusWithin","setFocusWithin","useState","createElement","Provider","value","useFocusWithin","useContext","callback","id","isFocused","useEffect","readline","emitKeypressEvents","process","stdin","on","str","key","name","pause","setRawMode","Item","label","useFocus","Text","inverse","Pane","ids","checkFocusWithin","isFocusWithin","has","useInput","input","return","console","log","Box","borderColor","borderDimColor","borderStyle","flexDirection","height","width","App","idSet1","Set","idSet2","Fragment","render"],"mappings":"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"}