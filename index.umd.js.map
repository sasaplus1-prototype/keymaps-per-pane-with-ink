{"version":3,"file":"index.umd.js","sources":["index.jsx"],"sourcesContent":["import * as readline from 'node:readline';\nimport React, { useContext, useState, useEffect } from 'react';\nimport { Box, render, Text, useFocus, useInput } from 'ink';\n\nconst FocusWithinContext = React.createContext();\n\nfunction FocusProvider(props) {\n  const { children } = props;\n  const [focusWithin, setFocusWithin] = useState('');\n\n  return (\n    <FocusWithinContext.Provider value={{ focusWithin, setFocusWithin }}>\n      {children}\n    </FocusWithinContext.Provider>\n  );\n}\n\nfunction useFocusWithin() {\n  const { focusWithin, setFocusWithin } = useContext(FocusWithinContext);\n\n  return [\n    (callback) => {\n      return callback(focusWithin);\n    },\n    (id, isFocused) => {\n      useEffect(() => {\n        if (isFocused) {\n          setFocusWithin(id);\n        }\n      }, [isFocused, setFocusWithin, id]);\n    }\n  ];\n}\n\n//------------------------------------------------------------------------------\n\nreadline.emitKeypressEvents(process.stdin);\n\nprocess.stdin.on('keypress', function (str, key) {\n  if (key && key.name === 'q') {\n    process.stdin.pause();\n  }\n});\nprocess.stdin.setRawMode(true);\n\n//------------------------------------------------------------------------------\n\nfunction Item(props) {\n  const { id, label } = props;\n  const { isFocused } = useFocus({ id });\n  const [, setFocusWithin] = useFocusWithin();\n\n  setFocusWithin(id, isFocused);\n\n  return (\n    <Text id={id} inverse={isFocused}>{label}</Text>\n  );\n}\n\nfunction Pane(props) {\n  const { children, id, ids } = props;\n\n  const [checkFocusWithin] = useFocusWithin();\n\n  const isFocusWithin = checkFocusWithin((id) => {\n    return ids.has(id);\n  });\n\n  useInput(\n    (input, key) => {\n      if (isFocusWithin && key.return) {\n        console.log(`I'm ${id}`);\n      }\n    }\n  );\n\n  return (\n    <Box\n      borderColor={isFocusWithin ? 'green' : 'red'}\n      borderDimColor={!isFocusWithin}\n      borderStyle=\"single\"\n      flexDirection=\"column\"\n      height=\"100%\"\n      width=\"50%\"\n    >\n      {children}\n    </Box>\n  );\n}\n\nfunction App() {\n  const idSet1 = new Set(['item-1', 'item-2', 'item-3']);\n  const idSet2 = new Set(['item-4', 'item-5', 'item-6']);\n\n  return (\n    <React.Fragment>\n      <FocusProvider>\n        <Text>Press Tab to focus next item. Press q to exit.</Text>\n        <Box flexDirection=\"row\">\n          <Pane id=\"pane-1\" ids={idSet1}>\n            <Item id=\"item-1\" label=\"Item 1\" />\n            <Item id=\"item-2\" label=\"Item 2\" />\n            <Item id=\"item-3\" label=\"Item 3\" />\n          </Pane>\n          <Pane id=\"pane-2\" ids={idSet2}>\n            <Item id=\"item-4\" label=\"Item 4\" />\n            <Item id=\"item-5\" label=\"Item 5\" />\n            <Item id=\"item-6\" label=\"Item 6\" />\n          </Pane>\n        </Box>\n      </FocusProvider>\n    </React.Fragment>\n  );\n}\n\nrender(<App />);\n"],"names":["FocusWithinContext","React","createContext","FocusProvider","props","children","focusWithin","setFocusWithin","useState","createElement","Provider","value","useFocusWithin","useContext","callback","id","isFocused","useEffect","readline","emitKeypressEvents","process","stdin","on","str","key","name","pause","setRawMode","Item","label","useFocus","Text","inverse","Pane","ids","checkFocusWithin","isFocusWithin","has","useInput","input","return","console","log","Box","borderColor","borderDimColor","borderStyle","flexDirection","height","width","App","idSet1","Set","idSet2","Fragment","render"],"mappings":"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"}